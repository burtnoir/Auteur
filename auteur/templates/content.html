{% extends "layout.html" %}
{% block body %}
<div class=row>
  <div class=col-md-3>
  

    <div class="panel panel-info">
      <div class="panel-heading">
        <h3 class="panel-title">{{ project.name }}</h3>
        </div>
        <div class="panel-heading">
    <div class="btn-group btn-group-justified" role="group">
      <div class="btn-group" role="group">
        <button id="tree_add" type="button" class="btn btn-default">Add</button>
      </div>
      <div class="btn-group" role="group">
        <button id="tree_rename" type="button" class="btn btn-default">Rename</button>
      </div>
      <div class="btn-group" role="group">
        <button id="tree_delete" type="button" class="btn btn-default">Delete</button>
      </div>
    </div>
      </div>
      
      <div id=tree></div>

     </div>
  </div>
  <div class=col-md-9>

  	<form id=mainform action="{{ url_for('update_section') }}" method=post>
      <div class="form-group">
        <textarea id=sectiontext name=sectiontext>{{ section.body }}</textarea>
        <input id="section_id" name="section_id" type="hidden" value="{{ section.id }}"/>
      </div>
      <button class="btn btn-primary btn-block" type=submit role="button">Save</button>
    </form>

  </div>
</div>

<script src="{{ url_for('static', filename='content.js') }}"></script>
<script>
  var treeData = [
                {% for item in structure %}
                  { "id"     : {{ item.id }}, 
                    "parent" : {% if item.parent_id %} "{{ item.parent_id }}" {% else %} "#" {% endif %}, 
                    "text"   : "{{ item.title }}",
                    "data"   : {"displayorder"  : {{ item.displayorder }} }
                  },
                {% else %}
                     { "id" : "0", "parent" : "#", "text" : "Oops, there's no structure.  Should create the first node when creating a new project." }
                {% endfor %}
                ];
                
  $('#tree_add').click(function(){
    treeAdd({{ project.id }});
  });
  
  $('#tree_rename').click(function() {
    treeRename();
  });

  $('#tree_delete').click(function() {
    treeDelete();
  });
</script>
{% endblock %}
